## R√©gression logistique

::: {.callout-note appearance="simple"}
Prompt : 

* Comment faire une r√©gression logistique sous R? 


:::

----

## ChatGPT {style="background-color: #f0f8ff; padding: 20px;"}
![ChatGPT](../img/ChatGPT.PNG)

La r√©gression logistique sous R est un outil statistique permettant de mod√©liser une variable d√©pendante binaire (ayant deux modalit√©s, comme 0/1, vrai/faux) en fonction de variables explicatives. Voici les √©tapes pour effectuer une r√©gression logistique sous R :

---

### 1. **Importer les donn√©es**
Chargez vos donn√©es dans R avec une fonction comme `read.csv()` ou en utilisant des ensembles de donn√©es int√©gr√©s (ex. `mtcars`).

```R
# Exemple de chargement des donn√©es
data <- read.csv("votre_fichier.csv")
```

---

### 2. **Explorer et pr√©parer les donn√©es**
Avant d‚Äôajuster le mod√®le, inspectez vos donn√©es.

```R
# Aper√ßu des donn√©es
head(data)
summary(data)

# V√©rifiez les valeurs manquantes
sum(is.na(data))

# Convertissez la variable cible en facteur (si n√©cessaire)
data$variable_cible <- as.factor(data$variable_cible)
```

---

### 3. **Ajuster le mod√®le**
Utilisez la fonction `glm()` pour effectuer une r√©gression logistique. Sp√©cifiez `family = binomial` pour indiquer qu‚Äôil s‚Äôagit d‚Äôun mod√®le logistique.

```R
# Ajuster le mod√®le
modele <- glm(variable_cible ~ var1 + var2, data = data, family = binomial)

# Afficher le r√©sum√© du mod√®le
summary(modele)
```

---

### 4. **Interpr√©ter les r√©sultats**
Le r√©sum√© du mod√®le fournit :
- Les coefficients (`Estimate`) : Log-odds (logarithme des chances).
- Les valeurs de p (`Pr(>|z|)`) : Significativit√© des variables explicatives.

---

### 5. **V√©rifier la qualit√© du mod√®le**
- **Pseudo-R¬≤ :** Utilisez des fonctions comme `pscl::pR2()`.
- **Table de confusion et pr√©cision :**

```R
# Pr√©dictions (probabilit√©s)
predictions <- predict(modele, type = "response")

# Convertir en classes (0/1)
classes_predites <- ifelse(predictions > 0.5, 1, 0)

# Table de confusion
table(observed = data$variable_cible, predicted = classes_predites)
```

---

### 6. **Visualiser les r√©sultats**
Vous pouvez visualiser la courbe ROC pour √©valuer les performances du mod√®le.

```R
library(pROC)

# Courbe ROC
roc_curve <- roc(data$variable_cible, predictions)
plot(roc_curve)
auc(roc_curve) # Aire sous la courbe
```

---

### Exemple Complet
Voici un exemple bas√© sur le dataset `mtcars` pour pr√©dire si une voiture est automatique (`am = 0`) ou manuelle (`am = 1`), bas√© sur la consommation (`mpg`) et la puissance (`hp`).

```R
# Convertir la variable cible en facteur
mtcars$am <- as.factor(mtcars$am)

# Ajuster le mod√®le
modele <- glm(am ~ mpg + hp, data = mtcars, family = binomial)

# R√©sum√© du mod√®le
summary(modele)

# Pr√©dictions
predictions <- predict(modele, type = "response")
classes_predites <- ifelse(predictions > 0.5, 1, 0)

# Table de confusion
table(observed = mtcars$am, predicted = classes_predites)

# Courbe ROC
library(pROC)
roc_curve <- roc(mtcars$am, predictions)
plot(roc_curve)
auc(roc_curve)
```

--- 

Si vous avez besoin de plus de d√©tails ou d‚Äôune adaptation sp√©cifique √† vos donn√©es, n‚Äôh√©sitez pas √† demander !

----

## Copilot {style="background-color: #faa555; padding: 20px;"}
![Copilot](../img/copilot.PNG)

La r√©gression logistique est un outil puissant pour analyser des variables binaires en fonction de variables explicatives. Voici comment r√©aliser une r√©gression logistique sous R:

1. **Pr√©paration des donn√©es**:
   - Supposons que vous ayez une variable binaire (par exemple, 1 pour "oui" et 0 pour "non") que vous souhaitez expliquer en fonction d'une variable explicative quantitative (par exemple, l'√¢ge).
   - Vous pouvez utiliser la fonction `glm()` (Mod√®le Lin√©aire G√©n√©ralis√©) pour estimer un mod√®le de r√©gression logistique.

2. **Mod√©lisation**:
   - Voici la formule g√©n√©rale pour la r√©gression logistique:
     $$ \log\left(\frac{p}{1-p}\right) = \beta_0 + \beta_1 \cdot x $$
     o√π:
     - \(p\) est la probabilit√© de succ√®s (valeur binaire).
     - \(\beta_0\) est l'intercept.
     - \(\beta_1\) est le coefficient associ√© √† la variable explicative \(x\).
   - La fonction de lien utilis√©e pour la r√©gression logistique est le logit (ou log-odds).

3. **Exemple de code**:
   ```R
   # Chargement des donn√©es (x: √¢ge, y: achat d'album de death metal)
   x <- c(30, 25, 40, ...)  # √Çges des personnes
   y <- c(0, 1, 0, ...)    # 0: Non, 1: Oui (achat d'album)

   # R√©gression logistique
   myreg <- glm(y ~ x, family = binomial(link = logit))
   summary(myreg)  # Affiche les coefficients et les statistiques

   # Transformation inverse pour obtenir les probabilit√©s
   logit_ypredit <- -0.12 * x + 5.95
   ypredit <- exp(logit_ypredit) / (1 + exp(logit_ypredit))

   # Trac√© de la courbe
   plot(x, y)
   points(x, ypredit, col = "red")
   ```
   - Dans l'exemple, l'influence n√©gative de l'√¢ge sur l'achat d'albums de death metal est significative au seuil de 5%.

N'h√©sitez pas si vous avez besoin d'aide suppl√©mentaire ! üòä

Source : conversation avec Copilot, 24/07/2024
(1) R√©gression Logistique dans Rstudio. Comment faire la r√©gressionlogistique dans R?. https://www.youtube.com/watch?v=sopRAKHtm3g.
(2) Regression logistique avec R part2. https://www.youtube.com/watch?v=AekWTxpyjvs.
(3) Regression logistique avec R part1. https://www.youtube.com/watch?v=6LTHZgYv6Nc.
(4) R√©aliser une r√©gression logistique avec R - R-atique. https://perso.ens-lyon.fr/lise.vaudor/realiser-une-regression-logistique-avec-r/.
(5) Un guide complet de la r√©gression logistique en R - ICHI.PRO. https://ichi.pro/fr/un-guide-complet-de-la-regression-logistique-en-r-49515274030415.
(6) 5 Regression logistique | Analyses statistiques avec R - Bookdown. https://bookdown.org/evraloui/lbira2110/regression-logistique.html.
(7) undefined. https://github.com/alibezzaa/Logistic-regression.git.
(8) √âquation de r√©gression logistique en R : Comprendre la formule avec des .... https://bing.com/search?q=r%c3%a9gression+logistique+R.
(9) √âquation de r√©gression logistique en R : Comprendre la formule avec des .... https://docs.kanaries.net/fr/topics/R/logistic-regression-equation-in-r.
(10) R√©gression logistique - Explication simple - DATAtab. https://datatab.fr/tutorial/logistic-regression.